<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catálogo de Séries e Animes</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="icon" href="./Logo.png" type="image/x-icon">
    <style>
        /* Estilos CSS para os cartões de série */
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap');
        body {
            background: #1d1d1d;
            font-family: 'Montserrat', 'sans-serif';
            color: #fff;
        }
        .series-card {
            border: 1px solid #ccc;
            border-radius: 8px;
            cursor: pointer;
            padding: 10px;
            text-align: center;
            background: rgba(0, 0, 0, .2);
            margin-bottom: 10px;
            padding: 20px;
            transition: transform 0.3s ease;
            margin-right: 5px; /* Espaçamento direito */
            margin-left: 5px; /* Espaçamento esquerdo */
        }
        .series-title {
            margin-bottom: 10px;
        }
        .series-poster {
            width: 100%;
            height: auto;
        }
        /* Estilos CSS para o modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
        }
        .modal-content {
            background: #1d1d1d;
            font-family: 'Montserrat', 'sans-serif';
            border-radius: 8px;
            max-width: 90%;
            margin: 50px auto;
            padding: 20px;
            max-height: 70vh;
            position: relative;
            overflow-y: auto;
        }
        .modal-close {
            position: absolute;
            top: 10px;
            right: 10px;
            cursor: pointer;
            font-size: 30px;
            color: #fff;
        }
        #EmbedderIframe {
            width: 100%;
            height: 400px;
        }
        #search-input {
            text-align: center;
        }
        .btn:hover {
            background: rgba(0, 0, 0, .2);
            color: #fff;
        }
    </style>
</head>
<body>
    <header style="background-color: #1d1d1d;" class="py-3">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-auto">
                    <a href="./index.html"><img id="logo" src="./Logo.png" style="width: 200px; height: auto;" /></a>
                </div>
                <div class="col-md">
                    <nav>
                        <ul class="nav justify-content-end">
                            <li class="nav-item">
                                <a class="nav-link text-white" href="./index.html">Filmes</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link text-white" href="./tv.html">Tv ao vivo</a>
                            </li>
                        </ul>
                    </nav>
                </div>
            </div>
        </div>
    </header>
    <h1 class="text-center">Catálogo de Séries e Animes Populares</h1>

    <div style="text-align: center;">
        <label for="genre-filter">Filtrar por Gênero:</label>
        <select id="genre-filter">
            <option value="">Todos os gêneros</option>
            <option value="35">Comédia</option>
            <option value="10766">Novela</option>
            <option value="10767">Podcast</option>
            <option value="10768">Guerra e Política</option>
            <option value="37">Velho Oeste</option>
            <option value="18">Drama</option>
            <option value="16">Animação</option>
            <option value="80">Crime</option>
            <option value="99">Documentário</option>
            <option value="10751">Familia</option>
            <option value="10759">Ação e Aventura</option>
            <option value="10749">Romance</option>
            <option value="27">Terror</option>
            <option value="9648">Mistério</option>
            <option value="10765">Ficção Científica/Fantasia</option>
            <option value="53">Suspense</option>
            <option value="10762">Infantil</option>
            <option value="10764">Reality</option>
            <option value="10752">Guerra</option>
            <option value="10402">Musical</option>
            <!-- Adicione outras opções de gênero conforme necessário -->
        </select>
    </div>

    <input type="text" id="search-input" class="form-control" aria-label="Small" aria-describedby="inputGroup-sizing-sm" style="margin: auto; display: block; width: 20%; margin-bottom:15px" placeholder="Pesquisar Séries">


    <div class="container">
        <div class="row justify-content-center" id="series-container"></div>
    </div>
    

    <div id="series-container" class="container"></div>
    <div class="container">
        <div class="row">
            <div class="col-lg-6">
                <button id="prev-page" class="btn btn-lg btn-block">Página Anterior</button>
            </div>
            <div class="col-lg-6">
                <button id="next-page" class="btn btn-lg btn-block">Próxima Página</button>
            </div>
        </div>
    </div>

    <!-- Modal para exibir o vídeo -->
    <div id="series-modal" class="modal">
        <div class="modal-content">
            <span id="modal-close" class="modal-close">&times;</span>
            <h2 id="modal-title" class="text-center"></h2>
            <h3 id="sinopse-title" class="text-center">Sinopse</h3>
            <p id="modal-overview" class="text-center"></p>
            <h6 id="modal-obs" style="color: red;">Se você interagir com o vídeo e abrir outras páginas, é normal. Basta fechá-las para continuar interagindo. No entanto, isso pode acontecer mais de uma vez. Infelizmente, será necessário fechar as novas abas sempre que forem abertas.</h6>
            <p id="modal-vote-average" class="text-center"></p>
            <p id="modal-vote-count" class="text-center"></p>
            <div id="EmbedderIframe"></div>

            <div class="container" style="text-align: center; margin-top: 20px;">
                <button id="option1" class="btn btn-lg">Opção 1</button>
                <button id="option2" class="btn btn-lg">Opção 2</button>
                <button id="option3" class="btn btn-lg">Opção 3</button>
            </div>
        </div>
    </div>

    <script>
        const apiKey = 'c5c8e6e09d68c0e14442d88242f42487';
        let currentPage = 1;
        let selectedGenre = '';

        async function fetchPopularSeries(page) {
            const response = await fetch(`https://api.themoviedb.org/3/tv/popular?api_key=${apiKey}&language=pt-BR&page=${page}`);
            const data = await response.json();
            return data.results;
        }

        async function fetchSeriesBySearch(query) {
            const response = await fetch(`https://api.themoviedb.org/3/search/tv?api_key=${apiKey}&language=pt-BR&query=${query}`);
            const data = await response.json();
            return data.results;
        }

        async function fetchSeriesByGenre(genreId, page) {
            const response = await fetch(`https://api.themoviedb.org/3/discover/tv?api_key=${apiKey}&language=pt-BR&sort_by=popularity.desc&page=${page}&with_genres=${genreId}`);
            const data = await response.json();
            return data.results;
        }

        function renderSeries(series) {
            const seriesContainer = document.getElementById('series-container');
            seriesContainer.innerHTML = '';
        
            series.forEach(serie => {
                const seriesCard = document.createElement('div');
                seriesCard.classList.add('col-lg-2', 'col-md-3', 'col-sm-4', 'col-6', 'mb-4', 'series-card');
        
                const seriesTitle = document.createElement('h2');
                seriesTitle.textContent = serie.name;
                seriesTitle.classList.add('series-title', 'text-center');
        
                const seriesPoster = document.createElement('img');
                seriesPoster.classList.add('series-poster');
                seriesPoster.src = `https://image.tmdb.org/t/p/w200${serie.poster_path}`;
                seriesPoster.alt = serie.name;
        
                seriesCard.appendChild(seriesTitle);
                seriesCard.appendChild(seriesPoster);
                seriesContainer.appendChild(seriesCard);
        
                seriesCard.addEventListener('click', () => {
                    openModal(serie);
                });
            });
        }
        
        

        async function openModal(serie) {
            const modal = document.getElementById('series-modal');
            const modalTitle = document.getElementById('modal-title');
            const modalOverview = document.getElementById('modal-overview');
            const modalVoteAverage = document.getElementById('modal-vote-average');
            const modalVoteCount = document.getElementById('modal-vote-count');
            const modalClose = document.getElementById('modal-close');
            const iframeContainer = document.getElementById('EmbedderIframe');

            const response = await fetch(`https://api.themoviedb.org/3/tv/${serie.id}?api_key=${apiKey}&language=pt-BR`);
            const data = await response.json();

            modalTitle.textContent = data.name;
            modalOverview.textContent = data.overview;
            modalVoteAverage.textContent = `Nota: ${data.vote_average} (${data.vote_count})`;
            iframeContainer.innerHTML = `<iframe id="videoIframe" src="https://superflixapi.top/serie/${serie.id}" scrolling="no" frameborder="0" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" width="100%" height="350"></iframe>`;

            document.getElementById('option1').addEventListener('click', () => {
                const link = `https://superflixapi.top/serie/${serie.id}`;
                iframeContainer.innerHTML = `<iframe id="videoIframe" src="${link}" scrolling="no" frameborder="0" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" width="100%" height="350"></iframe>`;
            });
            document.getElementById('option2').addEventListener('click', () => {
                const link = `https://supercdn.org/tvshow/${serie.id}`;
                iframeContainer.innerHTML = `<iframe id="videoIframe" src="${link}" scrolling="no" frameborder="0" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" width="100%" height="350"></iframe>`;
            });
            document.getElementById('option3').addEventListener('click', () => {
                const link = `https://embed.embedplayer.site/serie/${serie.id}/`;
                iframeContainer.innerHTML = `<iframe id="videoIframe" src="${link}" scrolling="yes" frameborder="0" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" width="100%" height="350"></iframe>`;
            });

            modal.style.display = 'block';

            modalClose.addEventListener('click', () => {
                modal.style.display = 'none';
                iframeContainer.innerHTML = '';
            });
        }

        async function searchAndRenderSeries(query) {
            try {
                const series = await fetchSeriesBySearch(query);
                renderSeries(series);
            } catch (error) {
                console.error('Erro ao pesquisar séries:', error);
            }
        }

        document.getElementById('prev-page').addEventListener('click', () => {
            if (currentPage > 1) {
                currentPage--;
                fetchAndRenderSeries(currentPage);
            }
        });

        document.getElementById('next-page').addEventListener('click', () => {
            currentPage++;
            fetchAndRenderSeries(currentPage);
        });

        document.getElementById('search-input').addEventListener('input', () => {
            const query = document.getElementById('search-input').value.trim();
            if (query !== '') {
                searchAndRenderSeries(query);
            } else {
                fetchAndRenderSeries(currentPage);
            }
        });

        document.getElementById('genre-filter').addEventListener('change', (event) => {
            const genreValue = event.target.value;
            selectedGenre = genreValue;
            fetchAndRenderSeries(1);
        });

        async function fetchAndRenderSeries(page) {
            try {
                let series = [];
                if (selectedGenre === '') {
                    series = await fetchPopularSeries(page);
                } else {
                    series = await fetchSeriesByGenre(selectedGenre, page);
                }
                renderSeries(series);
            } catch (error) {
                console.error('Erro ao obter séries:', error);
            }
        }

        fetchAndRenderSeries(currentPage);
    </script>
</body>
</html>
